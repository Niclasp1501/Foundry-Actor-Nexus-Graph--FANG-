<div class="fang-app-container">
    <!-- Sidebar / Toolbar -->
    <aside class="sidebar glass-panel">
        <header class="sidebar-header">
            <h1>{{localize "FANG.Name"}}</h1>
            <p>{{localize "FANG.Subtitle"}}</p>
        </header>

        <nav class="tabs-nav">
            <a class="tab-btn active" data-tab="editor"><i class="fas fa-hammer"></i> {{localize
                "FANG.UI.TabEditor"}}</a>
            <a class="tab-btn gm-only" data-tab="view"><i class="fas fa-eye"></i> {{localize "FANG.UI.TabView"}}</a>
            <a class="tab-btn gm-only" data-tab="advanced"><i class="fas fa-cogs"></i></a>
        </nav>

        <div class="tabs-container">
            <!-- EDITOR TAB -->
            <section class="tab-content active" data-tab="editor">
                <div class="control-group">
                    <h3>{{localize "FANG.UI.CreateConnection"}}</h3>
                    <div class="input-stack">
                        <select id="sourceSelect">
                            <option value="" disabled selected>{{localize "FANG.UI.SelectSource"}}</option>
                        </select>
                        <select id="targetSelect">
                            <option value="" disabled selected>{{localize "FANG.UI.SelectTarget"}}</option>
                        </select>
                        <input type="text" id="linkLabel" placeholder="{{localize 'FANG.UI.LabelPlaceholder'}}">
                        <div style="display: flex; align-items: center; gap: 5px; margin-top: 5px; margin-bottom: 5px;">
                            <input type="checkbox" id="linkDirectional" style="width: auto; margin: 0;">
                            <label for="linkDirectional" style="font-size: 0.9em;">{{localize
                                "FANG.UI.Directional"}}</label>
                        </div>
                        <button id="btnAddLink" class="btn secondary-btn">{{localize "FANG.UI.Connect"}}</button>
                    </div>
                </div>

                <div class="control-group">
                    <h3>{{localize "FANG.UI.ManageElements"}}</h3>
                    <div class="input-stack">
                        <select id="deleteSelect">
                            <option value="" disabled selected>{{localize "FANG.UI.SelectElement"}}</option>
                        </select>
                        <button id="btnDeleteElement" class="btn danger-btn"
                            style="margin-top: 5px; width: 100%; background: #8b0000; color: white;">
                            <i class="fas fa-trash"></i> {{localize "FANG.UI.Delete"}}
                        </button>

                        <div id="nodeEditGroup" class="input-stack hidden"
                            style="margin-top: 15px; border-top: 1px solid var(--fang-accent-gold); padding-top: 10px;">
                            <h3 style="font-size: 1.1em; color: var(--fang-accent-gold); margin-bottom: 5px;">{{localize
                                "FANG.UI.EditNodeHeader"}}</h3>

                            <div style="display: flex; gap: 5px;">
                                <button id="btnToggleCenter" class="btn action-btn" style="flex: 1;"
                                    title="{{localize 'FANG.UI.ToggleCenterHint'}}">
                                    <i class="fas fa-bullseye"></i> {{localize "FANG.UI.ToggleCenter"}}
                                </button>
                            </div>
                        </div>

                        <!-- Link Edit Group (Hidden by default) -->
                        <div id="linkEditGroup" class="input-stack hidden"
                            style="margin-top: 15px; border-top: 1px solid var(--fang-accent-gold); padding-top: 10px;">
                            <h3 style="font-size: 1.1em; color: var(--fang-accent-gold); margin-bottom: 5px;">{{localize
                                "FANG.UI.EditLinkHeader"}}</h3>
                            <p
                                style="font-size: 0.8em; color: #666; margin-top: 0; margin-bottom: 10px; line-height: 1.2;">
                                {{localize "FANG.UI.EditLinkHint"}}</p>

                            <input type="text" id="editLinkLabel" placeholder="{{localize 'FANG.UI.LabelPlaceholder'}}"
                                style="margin-bottom: 5px;">

                            <div
                                style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; padding: 2px 0;">
                                <label for="editLinkDirectional" style="font-size: 0.9em; cursor: pointer;">{{localize
                                    "FANG.UI.Directional"}}</label>
                                <input type="checkbox" id="editLinkDirectional"
                                    style="width: auto; margin: 0; cursor: pointer;">
                            </div>

                            <button id="btnUpdateLink" class="btn action-btn" style="width: 100%;">
                                <i class="fas fa-save"></i> {{localize "FANG.UI.UpdateLink"}}
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- VIEW / PRESENTATION TAB -->
            <section class="tab-content gm-only" data-tab="view">
                <div class="control-group">
                    <h3>{{localize "FANG.UI.Presentation"}}</h3>
                    <div class="input-stack">
                        <button id="btnShareGraph" class="btn action-btn"
                            title="{{localize 'FANG.UI.ShowPlayersHint'}}">
                            <i class="fas fa-eye"></i> {{localize "FANG.UI.ShowPlayers"}}
                        </button>
                        <button id="btnShareGraphMonitor" class="btn action-btn"
                            title="{{localize 'FANG.UI.ShowMonitorHint'}}" style="margin-top: 5px;">
                            <i class="fas fa-tv"></i> {{localize "FANG.UI.ShowMonitor"}}
                        </button>
                        <button id="btnCloseGraphRemote" class="btn action-btn"
                            title="{{localize 'FANG.UI.ClosePlayersHint'}}" style="margin-top: 5px;">
                            <i class="fas fa-times-circle"></i> {{localize "FANG.UI.ClosePlayers"}}
                        </button>
                        <button id="btnCloseGraphMonitor" class="btn action-btn"
                            title="{{localize 'FANG.UI.CloseMonitorHint'}}" style="margin-top: 5px;">
                            <i class="fas fa-desktop"></i> {{localize "FANG.UI.CloseMonitor"}}
                        </button>
                    </div>
                </div>

                <div class="control-group">
                    <h3>{{localize "FANG.UI.AdvancedFeatures"}}</h3>
                    <div class="input-stack">
                        <div
                            style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 5px; padding: 5px 0;">
                            <label for="cbAllowPlayerEdit"
                                style="font-size: 0.9em; font-weight: bold; cursor: pointer;">{{localize
                                "FANG.Settings.AllowPlayerEditing.Name"}}</label>
                            <input type="checkbox" id="cbAllowPlayerEdit"
                                style="width: auto; margin: 0; cursor: pointer;">
                        </div>
                        <p style="font-size: 0.8em; color: #666; margin-top: 0; margin-bottom: 5px; line-height: 1.2;">
                            {{localize "FANG.Settings.AllowPlayerEditing.Hint"}}
                        </p>
                    </div>
                </div>
            </section>

            <!-- ADVANCED TAB -->
            <section class="tab-content gm-only" data-tab="advanced">
                <div class="control-group">
                    <h3>{{localize "FANG.UI.ManageFactions"}}</h3>
                    <div class="input-stack">
                        <button id="btnManageFactions" class="btn action-btn" style="width: 100%;"
                            title="{{localize 'FANG.UI.ManageFactionsHint'}}">
                            <i class="fas fa-users-cog"></i> {{localize "FANG.UI.ManageFactions"}}
                        </button>
                    </div>
                </div>

                <div class="control-group actions-group">
                    <h3>{{localize "FANG.UI.Export"}} / {{localize "FANG.UI.Import"}}</h3>
                    <div class="button-row">
                        <button id="btnExportGraph" class="btn action-btn">
                            <i class="fas fa-download"></i> {{localize "FANG.UI.ExportBtn"}}
                        </button>
                        <label for="importFile" class="btn action-btn file-label">
                            <i class="fas fa-file-import"></i> {{localize "FANG.UI.ImportBtn"}}
                        </label>
                        <input type="file" id="importFile" accept=".json" style="display: none;">
                    </div>
                </div>
            </section>
        </div>
    </aside>

    <!-- Main Canvas Area -->
    <main class="canvas-container" style="position: relative;">
        <canvas id="graphCanvas"></canvas>

        <!-- Hover Information Tooltip -->
        <div id="fang-tooltip" class="fang-tooltip hidden"></div>

        <!-- Right-Click Radial Context Menu -->
        <div id="fang-context-menu" class="fang-context-menu hidden">
            <ul>
                <li id="ctxEditRole" class="ctx-item">
                    <i class="fas fa-theater-masks"></i> {{localize "FANG.ContextMenu.EditRole"}}
                </li>
                <li id="ctxEditLore" class="ctx-item">
                    <i class="fas fa-book-open"></i> {{localize "FANG.ContextMenu.EditLore"}}
                </li>
                <li id="ctxDeleteNode" class="ctx-item danger">
                    <i class="fas fa-trash"></i> {{localize "FANG.ContextMenu.DeleteNode"}}
                </li>
            </ul>
        </div>
    </main>
</div>